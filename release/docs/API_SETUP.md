# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Workspace API

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ Google Workspace API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Admin Team Tools.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Google Workspace** (—Ä–∞–Ω–µ–µ G Suite) –∞–∫–∫–∞—É–Ω—Ç —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –î–æ—Å—Ç—É–ø –∫ **Google Cloud Console**
- **Super Admin** –ø—Ä–∞–≤–∞ –≤ Google Workspace

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud Console

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"** –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Admin Team Tools")
4. –í—ã–±–µ—Ä–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**

### 2. –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö API

1. –í –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **"API –∏ —Å–µ—Ä–≤–∏—Å—ã" ‚Üí "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞"**
2. –ù–∞–π–¥–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ API:

#### Admin SDK API
- –ü–æ–∏—Å–∫: "Admin SDK API"
- –ù–∞–∂–º–∏—Ç–µ **"–í–∫–ª—é—á–∏—Ç—å"**

#### Google Calendar API
- –ü–æ–∏—Å–∫: "Google Calendar API" 
- –ù–∞–∂–º–∏—Ç–µ **"–í–∫–ª—é—á–∏—Ç—å"**

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –°–ø–æ—Å–æ–± 1: Service Account (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"API –∏ —Å–µ—Ä–≤–∏—Å—ã" ‚Üí "–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"**
2. –ù–∞–∂–º–∏—Ç–µ **"+ –°–û–ó–î–ê–¢–¨ –£–ß–ï–¢–ù–´–ï –î–ê–ù–ù–´–ï" ‚Üí "–ê–∫–∫–∞—É–Ω—Ç —Å–ª—É–∂–±—ã"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ**: Admin Team Tools Service
   - **–û–ø–∏—Å–∞–Ω–∏–µ**: Service account for Admin Team Tools
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å"**
5. –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ä–æ–ª–µ–π (–Ω–∞–∂–º–∏—Ç–µ **"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"**)
6. –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–µ –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–∂–º–∏—Ç–µ **"–ì–æ—Ç–æ–≤–æ"**)

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Service Account

1. –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account –≤ —Å–ø–∏—Å–∫–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –µ–≥–æ email –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–ö–ª—é—á–∏"**
4. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á" ‚Üí "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á"**
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø **JSON**
6. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**
7. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∫–∞–∫ `credentials.json` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Domain-wide Delegation

1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Service Account –Ω–∞–π–¥–∏—Ç–µ **"–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä"** (Client ID)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Admin Console](https://admin.google.com/)
3. –í—ã–±–µ—Ä–∏—Ç–µ **"–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" ‚Üí "–î–æ—Å—Ç—É–ø –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–∞–Ω–Ω—ã—Ö" ‚Üí "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API"**
4. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π"**
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Client ID**: —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ Service Account
   - **OAuth Scopes**: 
     ```
     https://www.googleapis.com/auth/admin.directory.user,
     https://www.googleapis.com/auth/admin.directory.group,
     https://www.googleapis.com/auth/calendar
     ```
6. –ù–∞–∂–º–∏—Ç–µ **"–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å"**

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ credentials.json

–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `credentials.json` –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–º–µ–Ω–µ:

```json
{
  "type": "service_account",
  "project_id": "your-project-id",
  "private_key_id": "...",
  "private_key": "...",
  "client_email": "...",
  "client_id": "...",
  "auth_uri": "...",
  "token_uri": "...",
  "auth_provider_x509_cert_url": "...",
  "client_x509_cert_url": "...",
  "subject": "admin@yourdomain.com"
}
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ó–∞–º–µ–Ω–∏—Ç–µ `admin@yourdomain.com` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π email Super Admin –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞.

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

- üö® **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ** `credentials.json` –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ
- üîí **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ —Ñ–∞–π–ª—É —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (chmod 600)
- üõ°Ô∏è **–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ** –∫–ª—é—á–∏ Service Account
- üìã **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π**

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

–î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
export GOOGLE_APPLICATION_CREDENTIALS="/path/to/credentials.json"
export GOOGLE_WORKSPACE_DOMAIN="yourdomain.com"
export GOOGLE_WORKSPACE_ADMIN="admin@yourdomain.com"
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ Admin Team Tools:

```bash
python main.py
```

–ï—Å–ª–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í —Å—Ç–∞—Ç—É—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—É–¥–µ—Ç "–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ Google Workspace API"
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "insufficient authentication scopes"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ OAuth Scopes –≤ Google Admin Console

### –û—à–∏–±–∫–∞: "Not Authorized to access this resource/api"

**–†–µ—à–µ–Ω–∏–µ**: 
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Domain-wide Delegation –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ Super Admin

### –û—à–∏–±–∫–∞: "The caller does not have permission"

**–†–µ—à–µ–Ω–∏–µ**: 
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–µ `subject` –≤ credentials.json
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - Super Admin

### –û—à–∏–±–∫–∞: "API not enabled"

**–†–µ—à–µ–Ω–∏–µ**: –í–∫–ª—é—á–∏—Ç–µ Admin SDK API –∏ Calendar API –≤ Google Cloud Console

## üìû –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [FAQ](FAQ.md)
2. –°–æ–∑–¥–∞–π—Ç–µ [Issue](https://github.com/Ashushkow/admin-team-tools/issues)
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ [Discussions](https://github.com/Ashushkow/admin-team-tools/discussions)
