# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û—à–∏–±–∫–∏ –∫–æ—Ä—É—Ç–∏–Ω –∏ —Ä–∞–∑—Ä—É—à–µ–Ω–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤

## üêõ –ü—Ä–æ–±–ª–µ–º—ã
1. **–û—à–∏–±–∫–∞ –∫–æ—Ä—É—Ç–∏–Ω**: `'coroutine' object is not iterable`
2. **RuntimeWarning**: `coroutine 'FreeIPAIntegration.list_users' was never awaited`  
3. **TclError**: `bad window path name` –∏ `invalid command name` –ø—Ä–∏ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–∏ –≤–∏–¥–∂–µ—Ç–æ–≤

## üîç –ü—Ä–∏—á–∏–Ω—ã

### 1. –û—à–∏–±–∫–∏ –∫–æ—Ä—É—Ç–∏–Ω
- –í UI –∫–æ–¥–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã `FreeIPAIntegration` –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ
- –ú–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –∫–æ—Ä—É—Ç–∏–Ω—ã –≤–º–µ—Å—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Å–µ—Ä–≤–∏—Å–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `hasattr`)

### 2. –û—à–∏–±–∫–∏ —Ä–∞–∑—Ä—É—à–µ–Ω–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
- –ü–æ—Å–ª–µ –æ—à–∏–±–∫–∏ –≤ –æ–∫–Ω–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∫–æ–¥ –ø—ã—Ç–∞–ª—Å—è –∑–∞–ø–∏—Å–∞—Ç—å –≤ —É–∂–µ —Ä–∞–∑—Ä—É—à–µ–Ω–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≤–∏–¥–∂–µ—Ç–æ–≤ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –∫ –Ω–∏–º

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Å–µ—Ä–≤–∏—Å–∞

**–ë—ã–ª–æ**:
```python
if hasattr(self.freeipa_service, 'list_users'):
    # –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
    users_data = self.freeipa_service.list_users()
```

**–°—Ç–∞–ª–æ**:
```python
service_class_name = self.freeipa_service.__class__.__name__

if service_class_name == 'FreeIPAService':
    # –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è FreeIPAService
    users_data = self.freeipa_service.list_users()
else:
    # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è FreeIPAIntegration
    import asyncio
    import inspect
    
    if inspect.iscoroutinefunction(self.freeipa_service.list_users):
        loop = asyncio.new_event_loop()
        asyncio.set_event_loop(loop)
        try:
            users_data = loop.run_until_complete(self.freeipa_service.list_users())
        finally:
            loop.close()
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ—Ä—É—Ç–∏–Ω—ã

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `inspect.iscoroutinefunction()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –º–µ—Ç–æ–¥–∞:

```python
import inspect

if inspect.iscoroutinefunction(self.freeipa_service.get_group_members):
    # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)
    try:
        members = loop.run_until_complete(self.freeipa_service.get_group_members(self.group_name))
    finally:
        loop.close()
else:
    # –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
    members = self.freeipa_service.get_group_members(self.group_name)
```

### 3. –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–∑—Ä—É—à–µ–Ω–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤

**–§–∞–π–ª**: `src/ui/freeipa_management.py`

**–ë—ã–ª–æ**:
```python
def _log_result(self, message: str):
    self.results_text.insert(tk.END, log_message)
    self.results_text.see(tk.END)
```

**–°—Ç–∞–ª–æ**:
```python
def _log_result(self, message: str):
    try:
        if hasattr(self, 'results_text') and self.results_text.winfo_exists():
            self.results_text.insert(tk.END, log_message)
            self.results_text.see(tk.END)
    except tk.TclError:
        # –í–∏–¥–∂–µ—Ç —É–∂–µ —Ä–∞–∑—Ä—É—à–µ–Ω, –ø—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
        pass
```

## üéØ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### –í `group_members_management.py`:
- ‚úÖ `load_freeipa_members()` - –∑–∞–≥—Ä—É–∑–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã
- ‚úÖ `load_freeipa_users()` - –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `add_to_freeipa_group()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø—É
- ‚úÖ `remove_from_freeipa_group()` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –≥—Ä—É–ø–ø—ã

### –í `freeipa_management.py`:
- ‚úÖ `_log_result()` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏:
1. **–ö–æ—Ä—É—Ç–∏–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - –Ω–µ—Ç –±–æ–ª—å—à–µ `'coroutine' object is not iterable`
2. **–ù–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π** - `RuntimeWarning` —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–æ–Ω** - –Ω–µ—Ç `TclError` –ø—Ä–∏ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–∏ –≤–∏–¥–∂–µ—Ç–æ–≤
4. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞ —Å `FreeIPAService` –∏ `FreeIPAIntegration`

### üéÆ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø FreeIPA
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π FreeIPA
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø—ã
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –≥—Ä—É–ø–ø
- ‚úÖ –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
UI Layer (Tkinter)
‚îú‚îÄ‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ –∫–ª–∞—Å—Å—É
‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ—Ä—É—Ç–∏–Ω—ã (inspect.iscoroutinefunction)
‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ/–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
‚îî‚îÄ‚îÄ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≤–∏–¥–∂–µ—Ç–∞–º–∏

Service Layer
‚îú‚îÄ‚îÄ FreeIPAService (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã)
‚îî‚îÄ‚îÄ FreeIPAIntegration (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã)
```

## üéâ –°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!

–í—Å–µ –æ—à–∏–±–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ:
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –∫–æ—Ä—É—Ç–∏–Ω
- ‚úÖ –ù–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ —Ä–∞–∑—Ä—É—à–µ–Ω–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –≥—Ä—É–ø–ø
