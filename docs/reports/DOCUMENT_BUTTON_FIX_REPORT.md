# –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∫–Ω–æ–ø–∫–∏ "–î–æ–∫—É–º–µ–Ω—Ç—ã"

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

### –°–∏–º–ø—Ç–æ–º—ã
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã" –ø–æ—è–≤–ª—è–ª–∞—Å—å –æ—à–∏–±–∫–∞ "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Google API"
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –æ—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã** –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ `document_service` –∏ –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
2. **–°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è credentials** —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
3. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤** - `DriveFile.owner_email` vs `DocumentInfo.owner`

## üîß –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
–ó–∞–º–µ–Ω–∏–ª–∏ –∏–º–ø–æ—Ä—Ç `DocumentService` –∏–∑ –ø–∞–∫–µ—Ç–∞ –Ω–∞ **–ª–æ–∫–∞–ª—å–Ω—É—é —É–ø—Ä–æ—â–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é**:

```python
# ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥ (—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã)
from src.services.document_service import DocumentService

# ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
from src.api.drive_api import DriveAPI

class DocumentService:
    """–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π DocumentService –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤"""
    def __init__(self, credentials):
        self.drive_api = DriveAPI(credentials)
        self.logger = logging.getLogger(__name__)
    
    def get_document_info(self, document_url):
        try:
            file_id = self.drive_api.extract_file_id_from_url(document_url)
            if not file_id:
                return None
            return self.drive_api.get_file_info(file_id)
        except Exception as e:
            self.logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–∫—É–º–µ–Ω—Ç–µ: {e}")
            return None
```

### 2. –£–ø—Ä–æ—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è credentials
–ó–∞–º–µ–Ω–∏–ª–∏ —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –Ω–∞ **–ø—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞**:

```python
# ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥ (—Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏)
google_client = None
if hasattr(self.service, 'user_service') and self.service.user_service:
    user_repo = self.service.user_service.user_repo
    if hasattr(user_repo, 'client'):
        google_client = user_repo.client
# ... –º–Ω–æ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫ ...

# ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ (–ø—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ)
from src.api.google_api_client import GoogleAPIClient
from src.config.enhanced_config import config

google_client = GoogleAPIClient(config.settings.google_application_credentials)
if not google_client.initialize():
    # –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
–ò—Å–ø—Ä–∞–≤–∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º `owner` –≤ –æ–±—ä–µ–∫—Ç–µ `DocumentInfo`:

```python
# ‚ùå –°—Ç–∞—Ä–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ DriveFile –Ω–∞–ø—Ä—è–º—É—é)
return self.drive_api.get_file_info(file_id)  # –£ DriveFile –µ—Å—Ç—å owner_email, –Ω–æ –Ω–µ owner

# ‚úÖ –ù–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Å–æ–∑–¥–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π DocumentInfo)
@dataclass
class DocumentInfo:
    file_id: str
    name: str
    url: str
    owner: str  # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç
    permissions: List[DrivePermission]

# –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
return DocumentInfo(
    file_id=drive_file.file_id,
    name=drive_file.name,
    url=drive_file.web_view_link,
    owner=drive_file.owner_email or "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",  # –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
    permissions=drive_file.permissions
)
```
- üîÑ –ù–∞—á–∞–ª–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- ‚úÖ –°–µ—Ä–≤–∏—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- üîÑ –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π Google API –∫–ª–∏–µ–Ω—Ç
- ‚úÖ Google API –∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- üîÑ –ü–æ–ª—É—á–∞–µ–º credentials
- ‚úÖ Credentials –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- üîÑ –°–æ–∑–¥–∞–µ–º DocumentService
- ‚úÖ DocumentService —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞ 'owner'
============================================================
‚úÖ Credentials –ø–æ–ª—É—á–µ–Ω—ã
‚úÖ DocumentService —Å–æ–∑–¥–∞–Ω
üîÑ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–∫—É–º–µ–Ω—Ç–µ...
‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–µ –ø–æ–ª—É—á–µ–Ω–∞:
   üìÑ ID: 1iXos0bTHv3nwXcYvAjPSIYzQOflcygwjj4LKD5Rftdk
   üìù –ù–∞–∑–≤–∞–Ω–∏–µ: –ö–æ–º–∞–Ω–¥–∞ –°–ø—É—Ç–Ω–∏–∫–∞
   üë§ –í–ª–∞–¥–µ–ª–µ—Ü: kim.alexanders@gmail.com  ‚úÖ –ê–¢–†–ò–ë–£–¢ –†–ê–ë–û–¢–ê–ï–¢!
   ÔøΩ URL: https://docs.google.com/document/d/1iXos0bTHv3nwXc...
   ÔøΩüîê –†–∞–∑—Ä–µ—à–µ–Ω–∏–π: 198
‚úÖ –ê—Ç—Ä–∏–±—É—Ç 'owner' —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!
```

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Google API –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ credentials –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ DocumentService
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ID –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–∑ URL
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–∫—É–º–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ Drive API
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

## üìç –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `src/ui/main_window.py` - –º–µ—Ç–æ–¥ `open_document_management()`
  - –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è credentials
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è DocumentService
  - –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **–°–Ω–∏–∂–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏** - —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏** - –ø—Ä—è–º–æ–π –ø—É—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è credentials
3. **–õ—É—á—à–∞—è –æ—Ç–ª–∞–¥–∫–∞** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
4. **–ò–∑–±–µ–∂–∞–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
üéØ **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û** - –∫–Ω–æ–ø–∫–∞ "üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã" —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ—à–∏–±–æ–∫
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - —É–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏  
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ø—Ä—è–º–æ–π –ø—É—Ç—å –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–û—Ç–ª–∞–¥–∫–∞** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã" 
- ‚úÖ –û–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ Drive API —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ OAuth 2.0 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞!
