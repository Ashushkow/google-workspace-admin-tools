# üîß –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Gmail API

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

‚úÖ **Gmail scope –¥–æ–±–∞–≤–ª–µ–Ω** –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
‚úÖ **OAuth —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç** Gmail scope  
‚ùå **Gmail scope –ù–ï –î–û–ë–ê–í–õ–ï–ù –≤ OAuth Consent Screen** –≤ Google Cloud Console

## üéØ –¢–æ—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

–•–æ—Ç—è Gmail scope –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–æ–∫–µ–Ω–µ, Google –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É "insufficient authentication scopes", –ø–æ—Ç–æ–º—É —á—Ç–æ **Gmail scope –Ω–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ OAuth Consent Screen** –≤ Google Cloud Console.

## üõ†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–´–ï —à–∞–≥–∏

### –®–∞–≥ 1: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å—Ç–µ Gmail scope –≤ OAuth Consent Screen
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [console.cloud.google.com](https://console.cloud.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç (–≥–¥–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã OAuth credentials)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"APIs & Services" ‚Üí "OAuth consent screen"**
4. –ù–∞–∂–º–∏—Ç–µ **"EDIT APP"**
5. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —à–∞–≥—É **"Scopes"** (—ç—Ç–æ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)
6. –ù–∞–∂–º–∏—Ç–µ **"ADD OR REMOVE SCOPES"**
7. –í –ø–æ–∏—Å–∫–µ –Ω–∞–π–¥–∏—Ç–µ **"Gmail API"**
8. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –æ—Ç–º–µ—Ç—å—Ç–µ: **"Send email on your behalf"**
   - Scope: `https://www.googleapis.com/auth/gmail.send`
9. –ù–∞–∂–º–∏—Ç–µ **"UPDATE"**
10. **–ó–∞–≤–µ—Ä—à–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –¥–æ –∫–æ–Ω—Ü–∞** –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### –®–∞–≥ 2: –í–∫–ª—é—á–∏—Ç–µ Gmail API (–µ—Å–ª–∏ –µ—â—ë –Ω–µ –≤–∫–ª—é—á–µ–Ω)
1. –í —Ç–æ–º –∂–µ –ø—Ä–æ–µ–∫—Ç–µ: **"APIs & Services" ‚Üí "Library"**
2. –ù–∞–π–¥–∏—Ç–µ **"Gmail API"**
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω **"ENABLED"**

### –®–∞–≥ 3: –ü–ï–†–ï–°–û–ó–î–ê–ô–¢–ï —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```bash
rm token.pickle
python main.py  # –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ scopes
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```bash
python setup_gmail_api.py
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚úÖ –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚úÖ Gmail scopes  
‚úÖ –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚úÖ Google API
‚úÖ Gmail —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

üéâ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´!
```

## ÔøΩ –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –í–°–Å–Å –µ—â—ë –æ—Å—Ç–∞–µ—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ OAuth Consent Screen —Å—Ç–∞—Ç—É—Å
```bash
python debug_gmail_scope.py
```

### –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Gmail scope —Ç–æ—á–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω:
1. –í Google Cloud Console –æ—Ç–∫—Ä–æ–π—Ç–µ **OAuth consent screen**
2. –ù–∞ —à–∞–≥–µ **"Scopes"** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω:
   ```
   ../auth/gmail.send
   Send email on your behalf
   ```
3. –ï—Å–ª–∏ –µ–≥–æ –ù–ï–¢ - –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–Ω–æ–≤–æ!

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –°–æ–∑–¥–∞–π—Ç–µ **–ù–û–í–´–ô** OAuth Client ID
2. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤—å—Ç–µ –≤—Å–µ scopes
3. –°–∫–∞—á–∞–π—Ç–µ –Ω–æ–≤—ã–π credentials.json
4. –£–¥–∞–ª–∏—Ç–µ token.pickle
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## ‚ö†Ô∏è –í–û–ó–ú–û–ñ–ù–´–ï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ
–ï—Å–ª–∏ OAuth consent screen –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "This app isn't verified":
1. –ù–∞–∂–º–∏—Ç–µ **"Advanced"**
2. –ù–∞–∂–º–∏—Ç–µ **"Go to [App Name] (unsafe)"**
3. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Gmail API –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –¥–æ–º–µ–Ω–∞
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Google Workspace Admin Console:
1. **Security ‚Üí API controls ‚Üí App access control**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Gmail API –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ê–∫–∫–∞—É–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç:
- –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä Google Workspace
- –ò–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –ø–∏—Å–µ–º

## üìß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   python main.py
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
   - ‚úÖ –û—Ç–º–µ—Ç—å—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ"
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å"

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω
   - –ü–∏—Å—å–º–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É –ø–æ–ª—É—á–∞—Ç–µ–ª—è

## üéØ –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

- **Gmail scope —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ‚úÖ
- **–ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–∫–ª—é—á–∏—Ç—å Gmail API** –≤ Google Cloud Console ‚öôÔ∏è
- **–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è API** –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ üöÄ

## üìû –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å

1. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `docs/GMAIL_API_SETUP.md`
2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: `python check_gmail_scope.py`
3. –ü—Ä–æ–≤–µ—Ä–∫–∞: `python setup_gmail_api.py`
