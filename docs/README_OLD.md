# Admin Team tools GUI

**Admin Team tools GUI** — это приложение на Python для управления пользователями и группами Google Workspace через Directory API с помощью графического интерфейса на Tkinter.

---

## Подробная инструкция по работе

### 1. Подготовка

- Убедитесь, что у вас установлен Python 3.8 или новее.
- Установите зависимости командой:
    ```sh
    pip install -r requirements.txt
    ```
- Получите файл `credentials.json` (OAuth 2.0 Client ID для Google Workspace Admin SDK) в Google Cloud Console и поместите его в папку проекта.

### 2. Запуск программы

- Запустите приложение:
    ```sh
    python main.py
    ```
- При первом запуске появится окно авторизации Google. Войдите под аккаунтом администратора Google Workspace. После успешной авторизации токен сохранится в `token.pickle`.

### 3. Основное окно

- В верхней части окна расположены две строки кнопок для быстрого доступа к функциям:
    - **Авторизоваться** — повторная авторизация, если требуется.
    - **Список пользователей** — загрузка и отображение всех пользователей домена.
    - **Создать пользователя** — открывает окно для добавления нового пользователя.
    - **Добавить в группу** — позволяет добавить выбранного пользователя в выбранную группу.
    - **Редактировать пользователя** — окно для изменения данных или удаления пользователя.
    - **Фильтр** — фильтрация пользователей по статусу, подразделению, имени или email.
    - **Переместить в подразделение** — перенос выбранного пользователя в другую организационную единицу.
    - **Asana Invite** — отправка приглашения в Asana.
    - **Группы** — управление группами (просмотр, добавление/удаление участников).
    - **Журнал** — просмотр журнала действий администратора (если реализовано).

### 4. Работа с пользователями

- **Просмотр пользователей:**  
  Нажмите "Список пользователей". В основном поле появится список всех пользователей с email и ФИО.
- **Фильтрация:**  
  Используйте кнопку "Фильтр" для поиска по email, имени, статусу (активен/заблокирован) и подразделению.
- **Создание пользователя:**  
  Кнопка "Создать пользователя" откроет форму. Заполните имя, фамилию, при необходимости — запасной email и телефон. Email формируется автоматически. Пароль можно ввести вручную или сгенерировать.
- **Редактирование пользователя:**  
  Кнопка "Редактировать пользователя" откроет окно, где можно выбрать пользователя, изменить его имя, фамилию, пароль или удалить.
- **Перемещение в подразделение:**  
  Выделите пользователя в списке, нажмите "Переместить в подразделение" и выберите нужную организационную единицу.

### 5. Работа с группами

- **Добавление в группу:**  
  Кнопка "Добавить в группу" откроет окно, где можно выбрать пользователя и группу для добавления.
- **Управление группами:**  
  Кнопка "Группы" откроет окно управления группами. Здесь можно:
    - Просматривать список групп и их участников.
    - Массово добавлять или удалять участников по email.
    - Просматривать подробную информацию о группе.

### 6. Приглашения в Asana

- Кнопка "Asana Invite" открывает окно для отправки приглашения пользователю в рабочее пространство Asana.

### 7. Журнал

- Кнопка "Журнал" (если реализовано) открывает окно просмотра истории действий администратора.

### 8. Безопасность

- Не публикуйте файлы `credentials.json` и `token.pickle`.
- Не храните реальные пароли и секреты в публичных репозиториях.
- Для отправки писем используйте отдельный сервисный аккаунт или безопасный SMTP.
- **Рекомендуется использовать переменные окружения для хранения секретов SMTP и Asana:**
  - В файле `settings.json` указывайте ключи `user_env`, `password_env`, `asana_token_env`.
  - Пример (settings.json):
    ```json
    "smtp": {
      "server": "smtp.gmail.com",
      "port": 587,
      "user_env": "SMTP_USER",
      "password_env": "SMTP_PASSWORD"
    },
    "asana_token_env": "ASANA_API_TOKEN"
    ```
  - Перед запуском программы задайте переменные окружения:
    ```sh
    $env:SMTP_USER="your_smtp_user"   # PowerShell
    $env:SMTP_PASSWORD="your_smtp_password"
    $env:ASANA_API_TOKEN="your_asana_token"
    ```
- **Никогда не размещайте реальные значения токенов, паролей и ключей в открытом доступе!**
- Для production используйте отдельные сервисные аккаунты и минимально необходимые права.

---

## Требования

- Python 3.8+
- Включён Google Workspace Admin SDK API
- Права администратора домена

## Лицензия

MIT License

---

**Внимание:**  
Для корректной работы требуется интернет и действующий аккаунт администратора Google
